#include <windows.h>
#include "lamb.h"

BOOL cursor_init = FALSE;
HMIBMP* csrbmp = make_bitmap(26,32,8);

DWORD cursor[] = {0xFFFFFFFF,0xFFFFFFFF,0xFFFFFFFF,0x00FFFFFF,0x95000091,0xFFFF0093,0xFFFFFFFF,0xFFFFFFFF,0xFFFFFFFF,0xFFFFFFFF,0x00FFFFFF,0xA3950094,0x00009395,0xFFFFFFFF,0xFFFFFFFF,
0xFFFFFFFF,0xFFFFFFFF,0x00FFFFFF,0xA3A3959B,0x9393A1A1,0xFFFFFF00,0xFFFFFFFF,0xFFFFFFFF,0xFFFFFFFF,0x9300FFFF,0xA5A4A396,0x90A3A3A5,0xFFFF0093,0xFFFFFFFF,0xFFFFFFFF,0xFFFFFFFF,
0x9591FFFF,0xA3A5A6A3,0xA2757372,0xFFFF0093,0xFFFFFFFF,0xFFFFFFFF,0xFFFFFFFF,0xA39800FF,0xA3A3A3A6,0x76A37572,0xFFFF9090,0xFFFFFFFF,0xFFFFFFFF,0xFFFFFFFF,0xA5A39300,0xA27673A5,
0x73767372,0xFFFF9190,0xFFFFFFFF,0xFFFFFFFF,0x00FFFFFF,0xA1A19500,0x76A375A2,0xA27372A3,0xFFFF9190,0xFFFFFFFF,0xFFFFFFFF,0x00FFFFFF,0xA1919500,0x74757372,0xA3A3A2A5,0xFFFF9095,
0xFFFFFFFF,0xFFFFFFFF,0x900000FF,0xA1919592,0xA29BA172,0xA193A2A3,0xFFFF9096,0xFFFFFFFF,0x00FFFFFF,0x92909000,0x91989593,0xA19B9BA1,0xA296A2A2,0xFFFF0096,0xFFFFFFFF,0x910000FF,
0x93909293,0x989B9593,0xA19B9891,0x919693A1,0xFFFF0096,0xFFFFFFFF,0x95939100,0x95939295,0x9B969393,0x9698989B,0x96969691,0xFFFFFF00,0xFFFFFFFF,0x95969391,0x98989393,0x98969396,
0x9B989898,0x00939898,0xFFFFFFFF,0x00FFFFFF,0x95969391,0x969B9593,0x96959696,0x98989898,0xFF009396,0xFFFFFFFF,0x9600FFFF,0x91939393,0x999B9691,0x95989898,0x91969696,0xFFFF0000,
0xFFFFFFFF,0xC0C000FF,0x91919396,0x98989B91,0x96989698,0x90999996,0xFFFFFF00,0xFFFFFFFF,0xC4C200FF,0x00909193,0x98989892,0x96969698,0x00999898,0xFFFFFFFF,0xFFFFFFFF,0xC0C400FF,
0x90000000,0x98999694,0x98969896,0x00989B99,0xFFFFFFFF,0xFFFFFFFF,0x00C400FF,0x920000FF,0x96989896,0x98969996,0x00989999,0xFFFFFFFF,0xFFFFFFFF,0x00C000FF,0x92900000,0x969B9B98,
0x94969996,0x00969994,0xFFFFFFFF,0xFFFFFFFF,0xFFFFFFFF,0x92919000,0x94989B98,0x969B9898,0x00969B98,0xFFFFFFFF,0xFFFFFFFF,0xFFFFFFFF,0x94929190,0x91969896,0x939B9B98,0x00959B96,
0xFFFFFFFF,0xFFFFFFFF,0x00FFFFFF,0x92929291,0x96919192,0x93939396,0xFF009191,0xFFFFFFFF,0xFFFFFFFF,0x9000FFFF,0x94949492,0x91910092,0x96969100,0xFFFF0091,0xFFFFFFFF,0xFFFFFFFF,
0x9200FFFF,0x98989894,0x00000094,0x0000FF00,0xFFFFFF00,0xFFFFFFFF,0xFFFFFFFF,0x9400FFFF,0x94C0C098,0xFFFFFF00,0xFFFFFFFF,0xFFFFFFFF,0xFFFFFFFF,0xFFFFFFFF,0x9400FFFF,0x92C2C2C0,
0xFFFFFF00,0xFFFFFFFF,0xFFFFFFFF,0xFFFFFFFF,0xFFFFFFFF,0x8300FFFF,0x00C0C6C2,0xFFFFFFFF,0xFFFFFFFF,0xFFFFFFFF,0xFFFFFFFF,0xFFFFFFFF,0xC200FFFF,0xFF00C0C6,0xFFFFFFFF,0xFFFFFFFF,
0xFFFFFFFF,0xFFFFFFFF,0xFFFFFFFF,0xC4C000FF,0xFFFF00C2,0xFFFFFFFF,0xFFFFFFFF,0xFFFFFFFF,0xFFFFFFFF,0xFFFFFFFF,0x00000000,0xFFFFFF00,0xFFFFFFFF,0xFFFFFFFF,0xFFFFFFFF,0xFFFFFFFF,
0xFFFFFFFF};

#define CURSOR_LOC 0x4D5248


HMIBMP* init_cursor(){
    CopyMemory(csrbmp->pBits,&cursor[0],0x380);
    cursor_init = TRUE;
}


void paste_cursor(HMIBMP* hbm, int dx, int dy){
    int cx,cy,col;
    BYTE* pix = csrbmp->pBits;
    WORD* pcsr=(WORD*)CURSOR_LOC;
    if(!cursor_init){init_cursor();}
    
    cx=(int)*pcsr-3;
    pcsr++;
    cy=(int)*pcsr-2;
    
    
    for(int y = csrbmp->height-1;y>=0;y--){
        for(int x=0;x<csrbmp->width;x++){
            col=(int)*(pix+x);
            if(col!=0xFF){
                safe_set_pixel(hbm,x+cx-dx,y+cy-dy,col);
            }
        }
        pix+=csrbmp->linew;        
    }
}












